{
  "dataset": {
    "train_dir": "./EV-UAV-dataset/EV-UAV-dataset/train",
    "val_dir": "./EV-UAV-dataset/EV-UAV-dataset/val",
    "test_dir": "./EV-UAV-dataset/EV-UAV-dataset/test",
    "chunk_size": 2000,
    "overlap": 0,
    "min_chunk_size": 2000,
    "use_chunking": true,
    "window_size": 4,
    "window_stride": 2,
    "coordinate_system": "normalized",
    "causal_history_len": 1000,
    "norm_stats_path": "norm_stats.json"
  },
  
  "features": {
    "base_features": {
      "x": true,
      "y": true,
      "timestamp": true,
      "polarity": true
    },
    "derived_features": {
      "relative_time": true,
      "polarity_encoded": true,
      "event_rate": true
    },
    "rate_window_past": 9,
    "normalization": {
      "normalize_coords": true,
      "normalize_features": true,
      "features_to_normalize": ["timestamp", "relative_time", "event_rate"],
      "features_no_normalize": ["polarity", "polarity_pos", "polarity_neg", "x", "y"]
    }
  },
  
  "model": {
    "type": "AblationEventModel",
    "num_classes": 2,
    "hidden_dim": 64,
    "window_size": 4,
    "dropout_rate": 0.1,
    "spatial_config": {
      "spatial_encoder_type": "knn",
      "knn": {
        "k_neighbors": 16,
        "spatial_radius": 1.0,
        "aggregation": "attention",
        "causal": true,
        "use_adaptive_temp": true,
        "spatial_weight": 1.0,
        "temporal_weight": 0.3,

        "use_rings": true,
        "k_total": 48,
        "ring_sizes": [16,16,16],
        "gate_use_time": true,
        "gate_hidden": 32
      }
    },
    "temporal_config": {
      "temporal_type": "mamba",
      "num_blocks": 1,
      "mamba": {
        "d_state": 16,
        "d_conv": 4,
        "expand": 2
      }
    }
  },
  
  "training": {
    "batch_size": 2,
    "num_epochs": 50,
    "learning_rate": 1e-4,
    "weight_decay": 1e-5,
    "gradient_clip": 1.0,
    "early_stopping_patience": 10,
    "focal_loss_alpha": 0.25,
    "focal_loss_gamma": 2.0
  },
  
  "inference": {
    "checkpoint_path": "best_model.pth",
    "save_txt_path": "predictions.txt",
    "threshold": 0.5,
    "chunk_size": 2000,
    "knn_history": 400,
    "use_streaming": false,
    "step_k": 1,
    "causal_knn": true,
    "device": "cuda",
    "rate_breaks": [2000.0, 10000.0, 50000.0, 100000.0],
    "rate_steps": [4, 16, 32, 64],
    "history_window": 1000,
    "min_step": 1
  },
  
  "seed": 42
}